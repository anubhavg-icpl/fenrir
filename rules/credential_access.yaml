- id: mimikatz_detection
  name: Mimikatz Credential Dumping Tool
  description: Detects the use of Mimikatz or similar credential dumping tools
  severity: critical
  mitre_attack:
    - T1003.001
  conditions:
    - type: ProcessName
      value: "*mimikatz*"
  actions:
    - Alert
    - Block
    - Quarantine
    - IncreaseRiskScore: 50.0

- id: lsass_memory_dump
  name: LSASS Memory Dumping
  description: Detects attempts to dump LSASS process memory
  severity: critical
  mitre_attack:
    - T1003.001
  conditions:
    - type: ProcessName
      value: "*"
    - type: CommandLine
      value: "*lsass*"
  actions:
    - Alert
    - Block
    - IncreaseRiskScore: 45.0

- id: suspicious_sam_access
  name: Suspicious SAM Database Access
  description: Detects access to the Security Account Manager database
  severity: high
  mitre_attack:
    - T1003.002
  conditions:
    - type: FileAccess
      path: "*\\config\\SAM"
      operation: "*"
  actions:
    - Alert
    - IncreaseRiskScore: 40.0

- id: credential_dumping_registry
  name: Credential Dumping via Registry
  description: Detects registry operations commonly used for credential dumping
  severity: high
  mitre_attack:
    - T1003.002
  conditions:
    - type: RegistryKey
      value: "*\\SAM\\SAM\\*"
  actions:
    - Alert
    - IncreaseRiskScore: 35.0